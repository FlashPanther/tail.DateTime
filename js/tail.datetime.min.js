/* tail.DateTime 0.3.0 @ https://github.com/pytesNET/tail.DateTime */
!function(c,o){"use strict";var h={hasClass:function(t,e){return new RegExp("(|s+)"+e+"(s+|)").test(t.className)},addClass:function(t,e){return this.hasClass(t,e)||(t.className=(t.className.trim()+" "+e.trim()).trim()),t},removeClass:function(t,e){var a=new RegExp("(|s+)("+e+")(s+|)");return a.test(t.className)&&(t.className=t.className.replace(a,"$1$3").trim()),t},trigger:function(t,e,a){if(CustomEvent&&"undefined"!=typeof CustomEvent){var s=new CustomEvent(e,a);return t.dispatchEvent(s)}return(s=o.createEvent("CustomEvent")).initCustomEvent(e,!!a.bubbles,!!a.cancelable,a.detail),t.dispatchEvent(s)}},u=function(t,e){if("string"==typeof t&&(t=o.querySelectorAll(t)),t instanceof NodeList||t instanceof HTMLCollection){if(0==t.length)return!1;for(var a=new Array,s=0;s<t.length;s++)a.push(new u(t[s],e));return 1==a.length?a[0]:a}if(void 0===this)return new u(t,e);if(!(t instanceof Element))return!1;if(t.hasAttribute("data-tail-calendar")&&u.instances[t.getAttribute("data-tail-calendar")])return u.instances[t.getAttribute("data-tail-calendar")];if("Object"==typeof e.dateRange&&e.dateRange instanceof Array&&(e.dateRanges=e.dateRange),delete e.dateRange,e.dateRanges&&0<e.dateRanges.length){var n;for(s=0;s<e.dateRanges.length;s++)"string"==typeof(n=e.dateRanges[s])[0]&&0<=p.shorts.indexOf(n[0])?(n[0]=p.shorts.indexOf(n[0]),n[1]=2<=n.length&&0<=p.shorts.indexOf(n[1])?p.shorts.indexOf(n[1]):6):("string"==typeof n[0]&&(n[0]=new Date(Date.parse(n[0])),2==n.length&&"string"==typeof n[1]?n[1]=new Date(Date.parse(n[1])):1==n.length&&(n[1]=new Date(n[0].getFullYear(),n[0].getMonth(),0))),n[0]instanceof Date&&!isNaN(n[0].getDate())||(n[0]=new Date),(n.length<2||!(n[1]instanceof Date)||isNaN(n[1].getDate()))&&(n[1]=new Date(n[0].getFullYear(),n[0].getMonth(),0)))}return this.e=t,this.con=Object.assign({},u.defaults,"object"==typeof e?e:{}),this.init()};u.version="0.3.0",u.status="alpha",u.count=0,u.isIE11=!!window.MSInputMethodContext&&!!document.documentMode,u.cache={},u.instances={},u.defaults={static:null,position:"bottom",classNames:"",dateFormat:"YYYY-mm-dd",timeFormat:"HH:ii:ss",dateRanges:[],weekStart:"SUN",startOpen:!1,stayOpen:!1,zeroSeconds:!1},u.strings={months:["January","February","March","April","May","June","July","August","September","October","November","December"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shorts:["SUN","MON","TUE","WED","THU","FRI","SAT"],time:["Hours","Minutes","Seconds"],header:["Select a Month","Select a Year","Select a Time"]};var p=u.strings;u.prototype={e:null,dt:null,con:{},view:{},select:null,init:function(){if(this.dt)return this.dt;var t=o.querySelector(this.con.static);this.dt=o.createElement("DIV"),this.dt.id="data-tail-calendar-"+ ++u.count,this.dt.className="tail-datetime-calendar calendar-close"+(t?" calendar-static":""),this.con.stayOpen&&(this.dt.className+=" calendar-stay"),this.con.classNames&&(this.dt.className+=" "+(this.con.classNames instanceof Array?this.con.classNames.join(" "):this.con.classNames)),this.con.dateFormat?this.dt.innerHTML='<div class="calendar-navi">    <span data-tail-navi="prev" class="calendar-button button-prev"></span>    <span data-tail-navi="switch" class="calendar-label"></span>    <span data-tail-navi="next" class="calendar-button button-next"></span></div><div class="calendar-date"></div>'+(this.con.timeFormat?'<div class="calendar-time">'+this.renderTime()+"</div>":""):this.dt.innerHTML='<div class="calendar-navi">    <span data-tail-navi="check" class="calendar-button button-check"></span>    <span data-tail-navi="switch" class="calendar-label">'+p.header[2]+'</span>    <span data-tail-navi="close" class="calendar-button button-close"></span></div>'+(this.con.timeFormat?'<div class="calendar-time">'+this.renderTime()+"</div>":"");var e=new Date(Date.parse(this.e.getAttribute("data-tail-value")||this.e.value));if(this.view={type:"date",date:new Date,content:"",render:function(){return this.content.querySelector("tbody").innerHTML}},isNaN(e.getDate())||(this.select=e,this.con.zeroSeconds&&this.select.setSeconds(0),this.view.date=new Date(this.select.getTime())),this.con.timeFormat&&(this.dt.querySelector(".calendar-field-h > input").value=this.view.date.getHours(),this.dt.querySelector(".calendar-field-m > input").value=this.view.date.getMinutes(),this.dt.querySelector(".calendar-field-s > input").value=this.view.date.getSeconds()),this.switchMonth(this.view.date.getMonth(),this.view.date.getFullYear()),this.e.hasAttribute("data-tail-value")?this.selectDate():this.e.setAttribute("data-tail-value",this.convertDate(this.view.date,"YYYY-mm-dd HH:ii:ss")),this.dt.style.zIndex=99,this.dt.style.position=t?"static":"absolute",this.dt.style.visibility=t?"visible":"hidden",t?t.appendChild(this.dt):o.getElementsByTagName("body")[0].appendChild(this.dt),!t){var a=c.getComputedStyle(this.dt),s=parseInt(a.marginLeft)+parseInt(a.marginRight),n=parseInt(a.marginTop)+parseInt(a.marginBottom),i=function(t){for(var e={top:t.offsetTop||0,left:t.offsetLeft||0,width:t.offsetWidth||0,height:t.offsetHeight||0};t=t.offsetParent;)e.top+=t.offsetTop,e.left+=t.offsetLeft;return e}(this.e);switch(this.con.position){case"top":this.dt.style.top=i.top-(this.dt.offsetHeight+n)+"px",this.dt.style.left=i.left+i.width/2-(this.dt.offsetWidth/2+s/2)+"px";break;case"left":this.dt.style.top=i.top+i.height/2-(this.dt.offsetHeight/2+n)+"px",this.dt.style.left=i.left-(this.dt.offsetWidth+s)+"px";break;case"right":this.dt.style.top=i.top+i.height/2-(this.dt.offsetHeight/2+n)+"px",this.dt.style.left=i.left+i.width+"px";break;default:this.dt.style.top=i.top+i.height+"px",this.dt.style.left=i.left+i.width/2-(this.dt.offsetWidth/2+s/2)+"px"}this.dt.style.display="none",this.dt.style.visibility="visible"}var l=this,r=this.dt.querySelectorAll("[data-tail-navi]");if(0<r.length)for(var d=0;d<r.length;d++)r[d].addEventListener("click",function(t){var e=this.getAttribute("data-tail-navi");l.con.dateFormat?"month"==l.view.type?"prev"==e||"next"==e?l.switchYear.call(l,e):l.switchView.call(l,"day"):"prev"==e||"next"==e?l.switchMonth.call(l,e):l.switchView.call(l,"month"):l.con.timeFormat&&("check"==e&&l.selectTime.call(l,parseInt(l.dt.querySelector(".calendar-field-h > input").value),parseInt(l.dt.querySelector(".calendar-field-m > input").value),parseInt(l.dt.querySelector(".calendar-field-s > input").value)),l.con.stayOpen||l.close.call(l))});return this.e.addEventListener("focusin",function(t){l.open.call(l)}),o.addEventListener("keyup",function(t){if(h.hasClass(l.dt,"calendar-open")&&27==t.keyCode&&(l.con.stayOpen||l.close.call(l),l.e.blur()),h.hasClass(l.dt,"calendar-open")&&13==t.keyCode){if(l.con.dateFormat){var e=l.dt.children[1].querySelector("td.today")||l.dt.children[1].querySelector("td:not(.empty)"),a=!!l.con.timeFormat;h.hasClass(e,"disabled")||l.selectDate.call(l,l.view.year,l.view.month,parseInt(e.value),a?parseInt(l.dt.querySelector(".calendar-field-h > input").value):0,a?parseInt(l.dt.querySelector(".calendar-field-m > input").value):0,a?parseInt(l.dt.querySelector(".calendar-field-s > input").value):0)}else l.selectTime.call(l,parseInt(l.dt.querySelector(".calendar-field-h > input").value),parseInt(l.dt.querySelector(".calendar-field-m > input").value),parseInt(l.dt.querySelector(".calendar-field-s > input").value));l.con.stayOpen||l.close.call(l),l.e.blur()}}),o.addEventListener("click",function(t){h.hasClass(l.dt,"calendar-open")&&(l.dt.contains(t.target)||l.e.contains(t.target)||t.target!=l.dt&&t.target!=l.e&&(l.con.stayOpen||l.close.call(l)))}),this.e.setAttribute("data-tail-calendar","tail-"+u.count),this.con.startOpen&&this.open(),u.instances["tail-"+u.count]=this},switchView:function(t){if(!this.con.dateFormat)return!1;if("month"==(this.view.type=t))this.dt.children[1].innerHTML="",this.dt.children[1].insertAdjacentHTML("afterbegin",this.renderMonth()),this.dt.querySelector(".calendar-label").innerText=this.view.date.getFullYear();else{this.dt.children[1].innerHTML=this.renderDay(),this.dt.querySelector(".calendar-label").innerText=p.months[this.view.date.getMonth()]+" "+this.view.date.getFullYear();var e=this.con.dateRanges,a=this.view.date,s=this.dt.querySelectorAll("tbody td:not(.empty)"),n=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0);if(0<e.length){for(var i=[],l=0;l<e.length;l++)if(e[l][0]instanceof Date){if(a.getYear()>=e[l][0].getYear()&&a.getYear()<=e[l][1].getYear()&&a.getMonth()>=e[l][0].getMonth()&&a.getMonth()<=e[l][1].getMonth())for(var r=0;r<s.length;r++)n.setDate(parseInt(s[r].innerText)),n>=e[l][0]&&n<=e[l][1]&&i.push(s[r].innerText)}else for(r=0;r<s.length;r++)n.setDate(parseInt(s[r].innerText)),3==e[l].length&&1==e[l][3]&&n.getDay()>=e[l][0]&&n.getDay()<=e[l][1]&&-1==i.indexOf(s[r].innerText)&&i.push(s[r].innerText),(n.getDay()<e[l][0]||n.getDay()>e[l][1])&&0<=i.indexOf(s[r].innerText)&&i.splice(i.indexOf(s[r].innerText),1);for(r=0;r<s.length;r++)-1==i.indexOf(s[r].innerText)&&h.addClass(s[r],"disable")}this.select instanceof Date&&this.select.getYear()==this.view.date.getYear()&&this.select.getMonth()==this.view.date.getMonth()?h.addClass(this.dt.querySelectorAll("tbody td:not(.empty)")[this.select.getDate()-1],"current"):this.dt.querySelector("tbody td.current")&&h.removeClass(this.dt.querySelector("tbody td.current"),"current")}var d=this;if(this.con.dateFormat){var c=this.dt.querySelectorAll("tbody td:not(.empty)");for(l=0;l<c.length;l++)c[l].addEventListener("click",function(t){if(t.preventDefault(),t.stopPropagation(),h.hasClass(this,"disable"))return!1;var e=!!d.con.timeFormat;"month"==d.view.type?d.switchMonth.call(d,parseInt(this.getAttribute("data-tail-month")),d.view.date.getFullYear()):(d.selectDate.call(d,d.view.date.getFullYear(),d.view.date.getMonth(),parseInt(this.innerText),e?parseInt(d.dt.querySelector(".calendar-field-h > input").value):0,e?parseInt(d.dt.querySelector(".calendar-field-m > input").value):0,e?parseInt(d.dt.querySelector(".calendar-field-s > input").value):0),d.con.stayOpen||d.close.call(d))})}},renderDay:function(){var t=p.shorts.indexOf(this.con.weekStart),e=p.shorts.slice(t);e=e.concat(p.shorts.slice(0,t));for(var a='<table class="calendar-day"><thead><tr>',s=0;s<7;s++)a+='<th data-tail-day="'+p.shorts.indexOf(e[s])+'">'+e[s]+"</th>";return a+="</tr></thead><tbody>",a+=this.createCalendar(this.view.date.getMonth(),this.view.date.getFullYear()).render(),a+="</tbody></table>"},renderMonth:function(){for(var t=p.months,e='<table class="calendar-month"><thead><tr><th colspan="4">'+p.header[0]+"</th></tr></thead><tbody>",a=0;a<12;a++)e+="<tr>",e+='<td class="calendar-month" data-tail-month="0"><span>'+t[a++]+"</span></td>",e+='<td class="calendar-month" data-tail-month="1"><span>'+t[a++]+"</span></td>",e+='<td class="calendar-month" data-tail-month="2"><span>'+t[a]+"</span></td>",e+="</tr>";return e+="</tbody></table>"},renderTime:function(){return'<div class="calendar-field calendar-field-h">    <input type="number" value="'+(new Date).getHours()+'" min="00" max="23" step="1" />    <label>'+p.time[0]+'</label></div><div class="calendar-field calendar-field-m">    <input type="number" value="'+(new Date).getMinutes()+'" min="00" max="59" step="1" />    <label>'+p.time[1]+'</label></div><div class="calendar-field calendar-field-s">    <input type="number" value="'+(new Date).getSeconds()+'" min="00" max="59" step="1" />    <label>'+p.time[2]+"</label></div>"},on:function(t,e){this.dt.addEventListener(t,e)},open:function(){return h.hasClass(this.dt,"calendar-close")&&(h.removeClass(this.dt,"calendar-close"),h.addClass(this.dt,"calendar-idle"),this.dt.style.opacity=0,this.dt.style.display="block",this.animate=setInterval(function(t){t.dt.style.opacity=parseFloat(t.dt.style.opacity)+.1,1<=parseFloat(t.dt.style.opacity)&&(h.removeClass(t.dt,"calendar-idle"),h.addClass(t.dt,"calendar-open"),h.trigger(t.dt,"tail.DateTime::open",{bubbles:!1,cancelable:!0,detail:t}),clearInterval(t.animate))},10,this)),this},close:function(){return h.hasClass(this.dt,"calendar-open")&&(h.removeClass(this.dt,"calendar-open"),h.addClass(this.dt,"calendar-idle"),this.animate=setInterval(function(t){t.dt.style.opacity=parseFloat(t.dt.style.opacity)-.1,parseFloat(t.dt.style.opacity)<=0&&(h.removeClass(t.dt,"calendar-idle"),h.addClass(t.dt,"calendar-close"),h.trigger(t.dt,"tail.DateTime::close",{bubbles:!1,cancelable:!0,detail:t}),t.dt.style.display="none",clearInterval(t.animate))},10,this)),this},toggle:function(){return h.hasClass(this.dt,"calendar-open")?this.close():h.hasClass(this.dt,"calendar-close")?this.open():this},remove:function(){return this.e.removeAttribute("data-fox-calendar"),this.td.parentElement.removeChild(this.td),null},switchMonth:function(t,e){return"prev"==t?this.view.date.setMonth(this.view.date.getMonth()-1):"next"==t?this.view.date.setMonth(this.view.date.getMonth()+1):(this.view.date.setMonth(t),this.view.date.setFullYear(e)),this.switchView("day"),this},switchYear:function(t){return"prev"==t?this.view.date.setFullYear(this.view.date.getFullYear()-1):"next"==t?this.view.date.setFullYear(this.view.date.getFullYear()+1):this.view.date.setFullYear(t),this.switchView("month"),this},selectDate:function(t,e,a,s,n,i){var l=new Date,r=[this.con.dateFormat?this.con.dateFormat:"",this.con.timeFormat?this.con.timeFormat:""].join(" ").trim();return this.select=new Date(t||(null==t?this.view.date.getFullYear():l.getFullYear()),e||(null==e?this.view.date.getMonth():l.getMonth()),a||(null==a?this.view.date.getDate():l.getDate()),s||(null==s?this.view.date.getHours():0),n||(null==n?this.view.date.getMinutes():0),i||(null==i?this.view.date.getSeconds():0)),h.trigger(this.dt,"tail.DateTime::select",{bubbles:!1,cancelable:!0,detail:self}),this.e.value=this.convertDate(this.select,r),this.e.setAttribute("data-tail-value",this.convertDate(this.select,"YYYY-mm-dd HH:ii:ss")),this.switchView(this.view.type)},selectTime:function(t,e,a){return this.selectDate(!1,!1,!1,t,e,a)},createCalendar:function(t,e){var a=1,s=!0,n=new Date(e,t,a).getDay(),i=[31,e%4==0&&e%100!=0||e%400==0?29:28,31,30,31,30,31,31,30,31,30,31],l=[];if((n-=p.shorts.indexOf(this.con.weekStart))<0&&(n=7+n),u.cache[this.con.weekStart+"_"+e]&&!u.isIE11){if(u.cache[this.con.weekStart+"_"+e][t])return u.cache[this.con.weekStart+"_"+e][t]}else u.cache[this.con.weekStart+"_"+e]={};for(var r=0;s;){l[r]=[];for(var d=0;d<7;d++)0===r?d===n&&(l[r][d]="<span>"+a+++"</span>",n++):a<=i[t]?l[r][d]="<span>"+a+++"</span>":(l[r][d]="",s=!1),i[t]<a&&(s=!1);r++}for(r=0;r<l.length;r++)l[r]='<tr><td class="calendar-day">'+l[r].join('</td><td class="calendar-day">')+"</td></tr>";var c=document.createElement("table");c.className="calendar-current",c.innerHTML=l.join("");var o=c.querySelectorAll("td:empty");for(r=0;r<o.length;++r)o[r].className+=" empty";t===(new Date).getMonth()&&Array.prototype.slice.call(c.querySelectorAll("td")).forEach(function(t,e,a){t.innerText===(new Date).getDate().toString()&&(t.className+=" today")});return this.view.date.setMonth(t),this.view.date.setFullYear(e),this.view=u.cache[this.con.weekStart+"_"+e][t]=Object.assign({},this.view,{content:c}),u.cache[this.con.weekStart+"_"+e][t]},convertDate:function(t,e){var a,s={H:String("00"+t.getHours()).toString().slice(-2),G:(a=t.getHours(),a%12?a%12:12),A:12<=t.getHours()?"PM":"AM",a:12<=t.getHours()?"pm":"am",i:String("00"+t.getMinutes()).toString().slice(-2),s:String("00"+t.getSeconds()).toString().slice(-2),Y:t.getFullYear(),y:parseInt(t.getFullYear().toString().slice(2)),m:String("00"+(t.getMonth()+1)).toString().slice(-2),M:p.months[t.getMonth()].slice(0,3),F:p.months[t.getMonth()],d:String("00"+t.getDate()).toString().slice(-2),D:p.days[t.getDay()],l:p.shorts[t.getDay()].toLowerCase()},n=new RegExp("(H{1,2}|G{1,2}|i{1,2}|s{1,2}|Y{2,4}|y{2}|m{1,2}|d{1,2})","g");return e=(e=e.replace(n,function(t){var e=s[t.slice(-1)].toString(),a=t.length;return 4==a||2==a?e.slice(-Math.abs(a)):1==a&&"0"==e[0]?e.slice(-1):e})).replace(/(A|a|M|F|D|l)/g,function(t){return s[t]})}},void 0===c.tail&&(c.tail={}),c.tail.DateTime=u}(window,document);
